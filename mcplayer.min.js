/* https://www.axel-hahn.de/ */
var mcPlayer=function(){this.cfg={about:{version:"0.33",label:"AMC Player - v0.33",description:"<strong>A</strong>xels <strong>M</strong>ulti <strong>C</strong>hannel <strong>Player</strong>.<br><br>This is a webbased HTML5 player.<br>It's focus is the handling of media in stereo and surround for a title.",labeldownload:"Download:<br>",download:"http://sourceforge.net/projects/amcplayer/files/latest/download",labellicense:"License: ",license:"GPL 3.0",labelurl:"Project url:<br>",url:"https://github.com/axelhahn/amcplayer/",labeldocurl:"Documentation:<br>",docurl:"https://www.axel-hahn.de/docs/amcplayer/index.htm"},links:{play:{title:"play"}},aPlayer:{buttons:{play:{sticky:true,title:"Play"},pause:{sticky:true,title:"Pause"},stop:{sticky:true,title:"Stop"},backward:{sticky:false,title:"Back"},forward:{sticky:false,title:"Forward"},jumpprev:{sticky:false,title:"Previous title"},jumpnext:{sticky:false,title:"Next title"},audiochannels:{title:"switch between stereo/ surround",noswitch:"stereo/ surround switch was deactivated (mobile device or Opera Presto engine)"},volmute:{visible:true,title:"Mute"},volfull:{visible:true,title:"Max. volume"},about:{visible:true,title:"about ...",box:"mcpabout"},playlist:{visible:true,title:"Toggle playlist",box:"mcpplaylist"},repeat:{visible:true,title:"Repeat"},shuffle:{visible:true,title:"Shuffle"},download:{visible:true,title:"Toggle download list",box:"mcpdownloads"},maximize:{label:"Player",sticky:false,title:"Show player"},minimize:{label:"",sticky:false,title:"Minimize"},statusbar:{label:"",title:"Toggle statusbar with network activity and media status"}},bars:{volume:{visible:true,title:"Set volume"},progress:{visible:true,title:"Set position"}},about:{title:"About ..."},playlist:{title:"Playlist"},download:{title:"Download audio files",noentry:"Select or play an audio first to show its downloads.",hint:"Use the right mousebutton or context menu to save the link target"},songinfo:{album:"Album",year:"Year",bpmspeed:"Speed",bpm:"bpm",genre:"Genre",url:"Web"},status:{networkstate:{label:"Network activity",0:["Empty","0 = NETWORK_EMPTY - audio/video has not yet been initialized"],1:["Idle","1 = NETWORK_IDLE - audio/video is active and has selected a resource, but is not using the network"],2:["Loading","2 = NETWORK_LOADING - browser is downloading data"],3:["No Source","3 = NETWORK_NO_SOURCE - no audio/video source found"]},readystate:{label:"Status",0:["Have nothing","0 = HAVE_NOTHING - no information whether or not the audio/video is ready"],1:["Have Metadata","1 = HAVE_METADATA - metadata for the audio/video is ready"],2:["OK, Current data","2 = HAVE_CURRENT_DATA - data for the current playback position is available, but not enough data to play next frame/millisecond"],3:["OK, Future data","3 = HAVE_FUTURE_DATA - data for the current and at least the next frame is available"],4:["OK, Enough data","4 = HAVE_ENOUGH_DATA - enough data available to start playing"]}}},settings:{autoopen:false,movable:true,repeatlist:true,showsonginfos:true,showhud:true,showstatusbar:false,shuffle:false,volume:0.9}};this.oAudio=false;this.sCurrentChannel=false;this.iMaxVol=1;this.iCurrentTime=false;this.bIsFading=false;this.iVolInc=0.02;this.iTimer=20;this.iHudTimer=5;this.iRemoveTimer=2;this.aPL=[];this.iCurrentSong=-1;this.aPlayorderList=[];this.iPlaylistId=-1;this._iMinDelta=100;this.sScreensize=false;this.name=false;this.playlink="[title]";this.canPlaySurround=function(){var b=true;if(navigator.userAgent.indexOf("Presto/")>=0){b=false}(function(c){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(c)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(c.substr(0,4))){b=false}})(navigator.userAgent||navigator.vendor||window.opera);this.bCanSurround=b;return b};this._scanAudios=function(){var e=document.getElementsByTagName("AUDIO");var h=new Array();var l=false;var k=false;var d=false;var c=false;for(var g=0;g<e.length;g++){e[g].style.display="none";d={title:e[g].dataset.title?e[g].dataset.title:e[g].title?e[g].title:"",artist:e[g].dataset.artist?e[g].dataset.artist:false,album:e[g].dataset.album?e[g].dataset.album:false,year:e[g].dataset.year?e[g].dataset.year:false,image:e[g].dataset.image?e[g].dataset.image:false,genre:e[g].dataset.genre?e[g].dataset.genre:false,bpm:e[g].dataset.bpm?e[g].dataset.bpm:false,url:e[g].dataset.url?e[g].dataset.url:false,sources:{}};for(var f=0;f<e[g].children.length;f++){c=e[g].children[f];if(c.tagName==="SOURCE"){k="any";if(c.title){k=c.title}l={src:c.src,type:c.type};if(!d.sources[k]){dummy=d.sources[k]=new Array()}dummy=d.sources[k].push(l)}}this.addAudio(d);var b=document.createElement("A");b.href="#";b.title=this.cfg.links.play.title+": "+d.title;b.innerHTML=this.playlink.replace("[title]","");b.setAttribute("onclick",this.name+".setSong("+g+"); /* "+this.name+".maximize(); */ return false;");b.setAttribute("class","songbtn icon-play");b.setAttribute("id","mcpaudioPlay"+g);e[g].parentNode.appendChild(b)}return h};this.addAudio=function(b){if(!b.sources){return false}if(!b.title){b.title="audio "+(this.aPL.length+1)}this.aPL.push(b);this._generatePlayorder()};this._genPlayer=function(){var c="";c+='<div id="mcpplayersonginfo"></div>';var e=new Array("play","pause","stop","backward","forward");if(this.aPL.length>1){e.push("jumpprev","jumpnext")}c+='<div id="mcpplayerbtndiv">';for(var b=0;b<e.length;b++){c+='<a href="#" id="mcp'+e[b]+'" onclick="'+this.name+".playeraction('"+e[b]+'\'); return false;" title="'+this.cfg.aPlayer.buttons[e[b]].title+'"></a>'}c+='</div><div id="mcpprogressdiv"'+(this.cfg.aPlayer.bars.progress.visible?"":'style="display: none"')+'><canvas id="mcpprogresscanvas" title="'+this.cfg.aPlayer.bars.progress.title+'"></canvas><div id="mcpprogressbar"></div></div><span id="mcptime"><span id="mcptimeplayed">-:--</span>/ <span id="mcptimetotal">-:--</span></span><div id="mcpvolumediv" title="volume"><a href="#" id="mcpvolmute" onclick="'+this.name+'.setVolume(0); return false;" '+(this.cfg.aPlayer.buttons.volmute.visible?"":'style="display: none" ')+'title="'+this.cfg.aPlayer.buttons.volmute.title+'"></a><canvas id="mcpvolumecanvas" '+(this.cfg.aPlayer.bars.volume.visible?"":'style="display: none" ')+'title="'+this.cfg.aPlayer.bars.volume.title+'"></canvas><a href="#" id="mcpvolfull" onclick="'+this.name+'.setVolume(1); return false;" '+(this.cfg.aPlayer.buttons.volfull.visible?"":'style="display: none" ')+'title="'+this.cfg.aPlayer.buttons.volfull.title+'"></a></div><div id="mcpchannels"></div><div id="mcpoptions"><a href="#" onclick="'+this.name+'.toggleRepeat(); return false;" id="mcpoptrepeat" '+(this.isRepeatlist()?'class="active" ':"")+'title="'+this.cfg.aPlayer.buttons.repeat.title+'"></a><a href="#" onclick="'+this.name+'.toggleShuffle(); return false;" id="mcpoptshuffle" '+(this.cfg.settings.shuffle?'class="active" ':"")+'title="'+this.cfg.aPlayer.buttons.shuffle.title+'"></a><a href="#" onclick="'+this.name+'.toggleStatusbar(); return false;" id="mcpoptstatusbar" '+(this.isVisibleStatusbar()?'class="active" ':"")+'title="'+this.cfg.aPlayer.buttons.statusbar.title+'"></a>';var d=["download","playlist","about"];for(var b=0;b<d.length;b++){idLink="mcpopt"+d[b];c+='<a href="#" onclick="'+this.name+".toggleBoxAndButton('"+d[b]+'\'); return false;" id="mcpopt'+d[b]+'" '+(this.cfg.aPlayer.buttons[d[b]].visible?"":'style="display: none" ')+' title="'+this.cfg.aPlayer.buttons[d[b]].title+'"></a>'}c+='</div><div id="mcpstatusbar"'+(this.cfg.settings.showstatusbar?' class="active" ':"")+"><div>"+this.cfg.aPlayer.status.networkstate.label+': <span id="mcpstatusnetwork"></span></div><div>'+this.cfg.aPlayer.status.readystate.label+': <span id="mcpstatusready"></span></div></div>';return c};this._genAboutbox=function(){return'<div class="mcpbox"><span class="ico-about"> '+this.cfg.aPlayer.about.title+'</span><span class="mcpsystembutton"><a href="#" class="icon-down-open-1" onclick="'+this.name+".toggleBoxAndButton('about', 'minimize'); return false;\" title=\""+this.cfg.aPlayer.buttons.minimize.title+'">'+this.cfg.aPlayer.buttons.minimize.label+'</a></span></div><div><p class="amclogo"></p><div class="title">'+this.cfg.about.label+"</div><p>"+this.cfg.about.description+"</p><hr><p>"+this.cfg.about.labellicense+""+this.cfg.about.license+"</p><p>"+this.cfg.about.labelurl+'<a href="'+this.cfg.about.url+'" target="_blank">'+this.cfg.about.url+"</a></p><p>"+this.cfg.about.labeldownload+'<a href="'+this.cfg.about.download+'" target="_blank">'+this.cfg.about.download+"</a></p><p>"+this.cfg.about.labeldocurl+'<a href="'+this.cfg.about.docurl+'" target="_blank">'+this.cfg.about.docurl+"</a></p></div>"};this._genPlaylist=function(){var c='<div class="mcpbox"><span class="ico-playlist"> '+this.cfg.aPlayer.playlist.title+'</span><span class="mcpsystembutton"><a href="#" class="icon-down-open-1" onclick="'+this.name+".toggleBoxAndButton('playlist', 'minimize'); return false;\" title=\""+this.cfg.aPlayer.buttons.minimize.title+'">'+this.cfg.aPlayer.buttons.minimize.label+"</a></span></div>";if(this.aPL.length>0){c+="<ul>";for(var b=0;b<this.aPL.length;b++){c+="<li"+(this.iCurrentSong===b?' class="active"':"")+'><a href="#" onclick="'+this.name+".setSong("+b+'); return false;">'+(this.aPL[b]["title"]?this.aPL[b]["title"]:"Audio #"+(b+1))+"</a></li>"}c+="</ul>"}return c};this._genSonginfos=function(){if(!this.cfg.settings.showsonginfos){return""}var b=""+(this.getSongArtist()?'<div class="artist">'+this.getSongArtist()+"</div>":"")+(this.getSongAlbum()?'<div class="album">'+this.cfg.aPlayer.songinfo.album+": "+this.getSongAlbum()+"</div>":"")+(this.getSongYear()?'<div class="year">'+this.cfg.aPlayer.songinfo.year+": "+this.getSongYear()+"</div>":"")+(this.getSongBpm()?'<div class="bpm">'+this.cfg.aPlayer.songinfo.bpmspeed+": "+this.getSongBpm()+" "+this.cfg.aPlayer.songinfo.bpm+"</div>":"")+(this.getSongGenre()?'<div class="genre">'+this.cfg.aPlayer.songinfo.genre+": "+this.getSongGenre()+"</div>":"")+(this.getSongUrl()?'<div class="url">'+this.cfg.aPlayer.songinfo.url+': <a href="'+this.getSongUrl()+'" target="_blank">'+this.getSongUrl()+"</a></div>":"");if(b||this.getSongImage()){b="<div>"+(this.getSongImage()?'<img src="'+this.getSongImage()+'">':"")+(this.getSongTitle()?'<div class="title">'+this.getSongTitle()+"</div>":"")+b;b+='<div style="clear: both;"></div>';b+="</div>"}return b};this._genDownloads=function(){var d="";if(this.aPL.length>0){d+='<div class="mcpbox"><span class="ico-download"> '+this.cfg.aPlayer.download.title+'</span><span class="mcpsystembutton"><a href="#" class="icon-down-open-1" onclick="'+this.name+".toggleBoxAndButton('download', 'minimize'); return false;\" title=\""+this.cfg.aPlayer.buttons.minimize.title+'">'+this.cfg.aPlayer.buttons.minimize.label+"</a></span></div><ul>";if(this.iCurrentSong===-1){d+="<li>"+this.cfg.aPlayer.download.noentry+"</li>"}else{d+="<li>"+this.cfg.aPlayer.download.hint+"<br><br></li>";for(var c=0;c<this.aPL.length;c++){sSong=this.aPL[c]["title"];if(!sSong){sSong="Audio #"+(c+1)}if(this.iCurrentSong===-1||this.iCurrentSong==c){d+="<li "+(this.iCurrentSong==c?' class="active"':"")+">"+sSong+"<ul>";for(var b in this.aPL[c]["sources"]){d+="<li>"+b+": ";for(j=0;j<this.aPL[c]["sources"][b].length;j++){sSrc=this.aPL[c]["sources"][b][j]["src"];sExt=this.aPL[c]["sources"][b][j]["type"].replace("audio/","");if(!sExt){sExt=this.aPL[c]["sources"][b][j]["src"].replace(/^.*\/|\.[^.]*$/g,"")}d+=(j>0?" | ":"")+'<a href="'+this.aPL[c]["sources"][b][j]["src"]+'" title="'+sSong+" ("+b+"; "+sExt+")\n"+this.aPL[c]["sources"][b][j]["src"]+'">'+sExt+"</a>"}d+="</li>"}d+="</ul></li>"}}}d+="</ul>"}return d};this._generatePlaylist=function(){this._scanAudios();this._generatePlayorder()};this._randomSort=function(d,c){return(parseInt(Math.random()*10)%2)};this._generatePlayorder=function(){this.aPlayorderList=[];if(this.aPL.length){for(var b=0;b<this.aPL.length;b++){this.aPlayorderList[b]=b}if(this.isShuffled()){if(this.iCurrentSong>=0){this.aPlayorderList.splice(this.iCurrentSong,1)}this.aPlayorderList.sort(this._randomSort);if(this.iCurrentSong>=0){this.aPlayorderList.unshift(this.iCurrentSong)}}this._findPlaylistId()}};this._findPlaylistId=function(){this.iPlaylistId=false;if(this.iCurrentSong>=0){for(var b=0;b<this.aPlayorderList.length;b++){if(this.aPlayorderList[b]===this.iCurrentSong){this.iPlaylistId=b}}}return this.iPlaylistId};this._initHtml=function(){var b=' style="top: '+((document.documentElement.clientHeight+100)+"px")+';"';this.oDivDownloads=document.getElementById("mcpdownloads");if(!this.oDivDownloads){document.getElementsByTagName("BODY")[0].innerHTML+='<div id="mcpdownloads" class="draggable saveposition"'+b+"></div>";this.oDivDownloads=document.getElementById("mcpdownloads")}this.oDivDownloads.innerHTML=this._genDownloads();this.oDivPlaylist=document.getElementById("mcpplaylist");if(!this.oDivPlaylist){document.getElementsByTagName("BODY")[0].innerHTML+='<div id="mcpplaylist" class="draggable saveposition"'+b+"></div>";this.oDivPlaylist=document.getElementById("mcpplaylist")}this.oDivPlaylist.innerHTML=this._genPlaylist();this.oDivPlayerwrapper=document.getElementById("mcpwrapper");if(!this.oDivPlayerwrapper){document.getElementsByTagName("BODY")[0].innerHTML+='<div id="mcpwrapper"'+(this.cfg.settings.movable?'class="draggable saveposition"':"")+"></div>";this.oDivPlayerwrapper=document.getElementById("mcpwrapper")}this.oDivHeader=document.getElementById("mcpheader");if(!this.oDivHeader){this.oDivPlayerwrapper.innerHTML+='<div id="mcpheader" class="mcpbox"><span class="ico-playlist"> '+this.cfg.about.label+' <span id="mcptitle"></span><span class="mcpsystembutton"><a href="#" class="icon-down-open-1" onclick="'+this.name+'.minimize(); return false" title="'+this.cfg.aPlayer.buttons.minimize.title+'">'+this.cfg.aPlayer.buttons.minimize.label+"</a></span></div>"}if(!this.oDivAudios){this.oDivPlayerwrapper.innerHTML+='<div id="mcpplayeraudios"></div>';this.oDivAudios=document.getElementById("mcpplayeraudios")}this.oDivPlayer=document.getElementById("mcplayer");if(!this.oDivPlayer){this.oDivPlayerwrapper.innerHTML+='<div id="mcplayer"></div>';this.oDivPlayer=document.getElementById("mcplayer");this.oDivPlayer.innerHTML=this._genPlayer()}this.oDivFooter=document.getElementById("mcpfooter");if(!this.oDivFooter){this.oDivPlayerwrapper.innerHTML+='<div id="mcpfooter">'+this.about+"</div>"}this.oAPlayermaximize=document.getElementById("mcpmaximize");if(!this.oAPlayermaximize){document.getElementsByTagName("BODY")[0].innerHTML+='<a href="#" id="mcpmaximize" class="mcpsystembutton hidebutton" onclick="'+this.name+'.maximize(); return false" title="'+this.cfg.aPlayer.buttons.maximize.title+'"> '+this.cfg.aPlayer.buttons.maximize.label+"</a>";this.oAPlayermaximize=document.getElementById("mcpmaximize")}document.getElementsByTagName("BODY")[0].innerHTML+='<div id="mcpabout" class="draggable saveposition"'+b+">"+this._genAboutbox()+"</div>";this.oDivPlayerhud=document.getElementById("mcphud");if(!this.oDivPlayerhud){document.getElementsByTagName("BODY")[0].innerHTML+='<div id="mcphud"></div>';this.oDivPlayerhud=document.getElementById("mcphud")}this._playerheightSet()};this.minimize=function(b){o=document.getElementById("mcpwrapper");o.style["transition-duration"]=b?"0s":"";o.style.top=(document.documentElement.clientHeight+this._iMinDelta)+"px";this.minimizeBox("about");this.minimizeBox("download");this.minimizeBox("playlist");document.getElementById("mcpmaximize").className=""};this.makeMainwindowMovable=function(b){this.cfg.settings.movable=b;o=document.getElementById("mcpwrapper");if(this.cfg.settings.movable){o.className="draggable saveposition";if(typeof addi!=="undefined"){addi.initDiv(o)}else{this.cfg.settings.movable=false}}if(!this.cfg.settings.movable){o.className="";if(typeof addi!=="undefined"){addi.resetDiv(o)}this.maximize();o.setAttribute("style","")}};this.maximize=function(){o=document.getElementById("mcpwrapper");o.setAttribute("style","");if(this.cfg.settings.movable&&typeof addi!=="undefined"){addi.load(document.getElementById("mcpwrapper"))}document.getElementById("mcpmaximize").className="hidebutton"};this._showInfo=function(b){if(!this.cfg.settings.showhud||this.cfg.settings.autoopen||this.isVisiblePlayer()){return false}var c=document.getElementById("mcphud");this.iRemoveTimer=this.iHudTimer*1000;c.className="active";c.innerHTML=b;this._decHudTimer();return true};this._hideInfo=function(){var b=document.getElementById("mcphud");b.className="";return true};this._decHudTimer=function(){this.iRemoveTimer=this.iRemoveTimer-100;if(this.iRemoveTimer>0){window.setTimeout(this.name+"._decHudTimer()",100)}else{this._hideInfo();this.iRemoveTimer=false}};this._togglehelperGetDiv=function(b){return(this.cfg.aPlayer.buttons[b]&&this.cfg.aPlayer.buttons[b].box)?document.getElementById(this.cfg.aPlayer.buttons[b].box):(b==="player")?document.getElementById("mcpwrapper"):false};this.toggleBoxAndButton=function(e,c,d){var b=this._togglehelperGetDiv(e);var f=document.getElementById("mcpopt"+e);if(!c){c=(f.className.indexOf("active")<0?"maximize":"minimize")}if(b){b.style["transition-duration"]=d?"0s":""}if(c==="minimize"){if(b){b.style.top=(document.documentElement.clientHeight+this._iMinDelta)+"px";b.style.opacity=0.1}if(f){f.className=""}}else{if(c==="maximize"){if(b){b.setAttribute("style","");b.style.opacity=1;if(typeof addi!=="undefined"){addi.load(b)}}if(f){f.className="active"}}}return true};this.isVisibleBox=function(c){var b=c==="player"?"mcpmaximize":"mcpopt"+c;var d=document.getElementById(b);return d?!!d.className:false};this.isVisibleBoxAbout=function(){return this.isVisibleBox("about")};this.isVisibleBoxDownload=function(){return this.isVisibleBox("download")};this.isVisibleBoxPlaylist=function(){return this.isVisibleBox("playlist")};this.isVisiblePlayer=function(){return this.isVisibleBox("player")};this.isVisibleStatusbar=function(){return this.cfg.settings.showstatusbar};this.toggleRepeat=function(){if(this.isRepeatlist()){return this.disableRepeat()}else{return this.enableRepeat()}};this.enableRepeat=function(){this.cfg.settings.repeatlist=true;this.toggleBoxAndButton("repeat","maximize")};this.disableRepeat=function(){this.cfg.settings.repeatlist=false;this.toggleBoxAndButton("repeat","minimize")};this.toggleShuffle=function(){if(this.isShuffled()){return this.disableShuffle()}else{return this.enableShuffle()}};this.enableShuffle=function(){this.cfg.settings.shuffle=true;this._generatePlayorder();this.toggleBoxAndButton("shuffle","maximize")};this.disableShuffle=function(){this.cfg.settings.shuffle=false;this._generatePlayorder();this.toggleBoxAndButton("shuffle","minimize")};this._setStatusbar=function(b){this.cfg.settings.showstatusbar=!!b;this.toggleBoxAndButton("statusbar",(b?"maximize":"minimize"));document.getElementById("mcpstatusbar").className=(b?"active":"");this._playerheightAdjust();return true};this.enableStatusbar=function(){return this._setStatusbar(true)};this.disableStatusbar=function(){return this._setStatusbar(false)};this.toggleStatusbar=function(){if(this.isVisibleStatusbar()){return this.disableStatusbar()}else{return this.enableStatusbar()}};this.minimizeBox=function(c,b){return this.toggleBoxAndButton(c,"minimize",b)};this.maximizeBox=function(c,b){return this.toggleBoxAndButton(c,"maximize",b)};this.playeraction=function(b){if(!this.oAudio){if(b==="play"){this.setSong(this.aPlayorderList[0])}else{return false}}switch(b){case"play":this.oAudio.play();break;case"pause":this.oAudio.pause();break;case"stop":this.oAudio.pause();try{this.oAudio.currentTime=0}catch(g){}break;case"forward":this.oAudio.currentTime+=10;break;case"backward":this.oAudio.currentTime-=10;break;case"jumpprev":this.setPreviousSong();break;case"jumpnext":this.setNextSong();break;default:alert("playeraction not implemented yet: ["+b+"]")}if(this.cfg.aPlayer.buttons[b].sticky){var c=document.getElementById("mcpplayerbtndiv");var f=c.getElementsByTagName("A");for(var d=0;d<f.length;d++){f[d].className=""}document.getElementById("mcp"+b).className="active"}};this.setAudioPosition=function(b){if(!this.sCurrentChannel||this.oAudio.duration<b){return false}return this.oAudio.currentTime=b};this.setPreviousSong=function(){if(!this.aPlayorderList||!this.aPlayorderList.length){return false}if(this.iPlaylistId>0){return this.setSong(this.aPlayorderList[this.iPlaylistId-1])}return this.setSong(this.aPlayorderList[this.aPlayorderList.length-1])};this.setNextSong=function(){if(!this.aPL||!this.aPL.length){return false}if(this.iPlaylistId<(this.aPlayorderList.length-1)){return this.setSong(this.aPlayorderList[this.iPlaylistId+1])}else{this._generatePlayorder();if(this.isRepeatlist()){this.setSong(this.aPlayorderList[(this.isShuffled()?1:0)])}}};this.setSong=function(c){if(!this.aPL[c]){return false}if(this.bIsFading){return false}var r="";var q="";var f=false;var p=false;var b=false;var n=0;if(this.oAudio){this.getVolume();this.oAudio.pause();try{this.oAudio.currentTime=0}catch(m){}this.oAudio=false}this.oDivAudios.innerHTML="";var k="";for(var l in this.aPL[c]["sources"]){if(this.aPL[c]["sources"][l].length){if(!f){f=l}if(p!==l){n++;q+="<li class";q+=">";if(this.bCanSurround){q+='<a href="#" onclick="'+this.name+".setChannel('"+l+'\'); return false;" title="'+this.cfg.aPlayer.buttons.audiochannels.title+": "+l+'">'+l+"</a>"}else{q+='<a href="#" onclick="return false;" title="'+this.cfg.aPlayer.buttons.audiochannels.noswitch+'">'+l+"</a>"}q+="</li>";p=l;if(l===this.sCurrentChannel){b=true}}r+='<audio id="mcp'+l+'" '+k+" >";for(h=0;h<this.aPL[c]["sources"][l].length;h++){source=this.aPL[c]["sources"][l][h];sourcesrc=String(source.src);if(sourcesrc.indexOf("?")<0){sourcesrc+="?"}r+='<source src="'+sourcesrc+'" type="'+source.type+'">'}r+="</audio>"}}if(n===1){q=""}document.getElementById("mcpplayeraudios").innerHTML=r;if(q){q="<ul>"+q+"</ul>"}document.getElementById("mcpchannels").innerHTML=q;this.iCurrentSong=c;this._findPlaylistId();document.getElementById("mcpplaylist").innerHTML=this._genPlaylist();document.getElementById("mcpdownloads").innerHTML=this._genDownloads();var d=this._genSonginfos();document.getElementById("mcpplayersonginfo").innerHTML=d;this._playerheightAdjust();document.getElementById("mcptitle").innerHTML=this.getSongTitle();var g=document.getElementsByTagName("A");for(var h=0;h<g.length;h++){oLink=g[h];if(oLink.className==="songbtn icon-play songbtnactive"){oLink.className="songbtn icon-play"}}o=document.getElementById("mcpaudioPlay"+c).className+=" songbtnactive";this.iCurrentTime=false;if(b){f=this.sCurrentChannel}this.sCurrentChannel=false;this.setChannel(f);this.playeraction("play",true);this._showInfo((c+1)+"/ "+this.aPL.length+"<br>&laquo;"+this.aPL[c]["title"]+"&raquo;");if(this.cfg.settings.autoopen){this.maximize()}return true};this._playerheightAdjust=function(){if(typeof addi!=="undefined"&&this.cfg.settings.movable){var f=document.getElementById("mcpwrapper");var d=f.style.top.replace("px","")/1;var b=d+f.clientHeight/2;var e=document.documentElement.clientHeight;if(b>e/3){var c=f.clientHeight-this._iHeightPlayerWindow;f.style.top=(b>2*e/3?(d-c):(d-c/2))+"px"}this._playerheightSet()}};this._playerheightSet=function(){this._iHeightPlayerWindow=document.getElementById("mcpwrapper").clientHeight};this.setChannel=function(c){var b=document.getElementById("mcpchannels");var f=b.getElementsByTagName("LI");if(f.length){for(var d=0;d<f.length;d++){oALI=f[d].getElementsByTagName("A");if(oALI&&oALI.length>0){oALI[0].className="";if(oALI[0].innerHTML&&oALI[0].innerHTML===c){var e=oALI[0].parentNode;oALI[0].className="active"}}f[d].className=""}}if(e){e.className="active"}if(this.sCurrentChannel===c){return false}if(this.bIsFading){return false}if(this.oAudio){this.iCurrentTime=this.oAudio.currentTime;this.getVolume();this._fadeOut(this.sCurrentChannel)}this.oAudio=false;if(c){oAudioTmp=document.getElementById("mcp"+c);oAudioTmp.idurationchange=0;oAudioTmp.isStream=false;oAudioTmp.lastDuration=false;this.oAudio=oAudioTmp;if(this.oAudio){this._wait4Audio(this.oAudio,this.iCurrentTime);this.oAudio.volume=this.cfg.settings.volume;document.getElementById("mcptimeplayed").innerHTML="?:??";document.getElementById("mcptimetotal").innerHTML="?:??";document.getElementById("mcptime").style.display="block";oAudioTmp.addEventListener("durationchange",function(){if(oAudioTmp.duration===Infinity){oAudioTmp.isStream=true}else{if(oAudioTmp.lastDuration!==oAudioTmp.duration){oAudioTmp.idurationchange++;oAudioTmp.lastDuration=oAudioTmp.duration;if(oAudioTmp.idurationchange>3){oAudioTmp.isStream=true}}}});oAudioTmp.addEventListener("timeupdate",function(){document.getElementById("mcpprogressdiv").style.display=oAudioTmp.isStream?"none":"";document.getElementById("mcptime").style.display=oAudioTmp.isStream?"none":"block";document.getElementById("mcppause").style.display=oAudioTmp.isStream?"none":"block";document.getElementById("mcpbackward").style.display=oAudioTmp.isStream?"none":"block";document.getElementById("mcpforward").style.display=oAudioTmp.isStream?"none":"block";if(!oAudioTmp.currentTime){document.getElementById("mcptimeplayed").innerHTML="-:--";document.getElementById("mcptimetotal").innerHTML="-:--";return false}if(oAudioTmp.isStream){return false}var n=parseInt(oAudioTmp.currentTime%60);var g=parseInt((oAudioTmp.currentTime/60)%60);if(n<10){n="0"+n}var l=parseInt(oAudioTmp.duration%60);var i=parseInt((oAudioTmp.duration/60)%60);if(l<10){l="0"+l}document.getElementById("mcptimeplayed").innerHTML=g+":"+n;document.getElementById("mcptimetotal").innerHTML=i+":"+l;var k=document.getElementById("mcpprogresscanvas");if(k.getContext){var h=k.getContext("2d");h.clearRect(0,0,k.width,k.height);var q=0.05+oAudioTmp.currentTime/oAudioTmp.duration/10*1;h.fillStyle="rgba(0,0,0, "+q+")";var p=Math.round((oAudioTmp.currentTime/oAudioTmp.duration)*(k.width));if(p>0){h.fillRect(0,0,p,k.height);h.strokeStyle="rgba(0,0,0,0.3)";h.lineWidth=1;h.beginPath();h.moveTo(p,0);h.lineTo(p,k.height);h.stroke()}}},false);document.getElementById("mcpprogresscanvas").addEventListener("click",function(i){var g=new Number();var l=document.getElementById("mcpwrapper");var k=document.getElementById("mcpprogressdiv");var h=document.getElementById("mcpprogresscanvas");if(i.x!==undefined&&i.y!==undefined){g=i.x}else{g=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft}g-=h.offsetLeft+l.offsetLeft+k.offsetLeft;if(oAudioTmp&&oAudioTmp.currentTime){oAudioTmp.currentTime=oAudioTmp.duration*(g/h.clientWidth)}},true);oAudioTmp.addEventListener("volumechange",function(){var h=document.getElementById("mcpvolumecanvas");if(h.getContext){var i=h.getContext("2d");i.clearRect(0,0,h.width,h.height);var k=0.05+oAudioTmp.volume/10*1;i.fillStyle="rgba(0,0,0, "+k+")";var g=Math.round(oAudioTmp.volume*h.width);if(g>0){i.fillRect(0,0,g,h.height);i.strokeStyle="rgba(0,0,0,0.3)";i.lineWidth=3;i.beginPath();i.moveTo((g),0);i.lineTo(g,h.height);i.stroke()}}},false);document.getElementById("mcpvolumecanvas").addEventListener("click",function(k){var g=new Number();var l=document.getElementById("mcpwrapper");var h=document.getElementById("mcpvolumecanvas");if(k.x!==undefined&&k.y!==undefined){g=k.x}else{g=k.clientX+document.body.scrollLeft+document.documentElement.scrollLeft}g-=h.offsetLeft+l.offsetLeft;try{localStorage.setItem("amcp.volume",g/h.clientWidth);oAudioTmp.volume=(g/h.clientWidth)}catch(i){console.error("Error:"+i)}},true);oAudioTmp.addEventListener("ended",function(){document.getElementById("mcpjumpnext").click()},false)}}this.sCurrentChannel=c;localStorage.setItem("amcp.channels",this.sCurrentChannel);return true};this.setConfig=function(b){this.cfg=realMerge(this.cfg,b)};this.setVolume=function(b){this.cfg.settings.volume=b;localStorage.setItem("amcp.volume",this.cfg.settings.volume);if(this.oAudio){this.oAudio.volume=b;return true}return false};this._wait4Audio=function(c,b){c.volume=0.001;c.play();if(b){c.currentTime=b}return true};this._fade=function(c,b){this.bIsFading=true;o=document.getElementById("mcp"+b);if(!o){return false}iVol=o.volume;iInc=(c<iVol?-this.iVolInc:this.iVolInc);iVol+=iInc;if((c===0&&iVol>0)||(c>0&&iVol<c)){o.volume=iVol;window.setTimeout(this.name+"._fade("+c+", '"+b+"')",this.iTimer)}else{this.bIsFading=false;o.volume=c;if(iVol<=0){o.pause()}}return true};this._fadeOut=function(b){this._fade(0,b)};this.getAudioChannels=function(){return this.sCurrentChannel};this.getAllAudioChannels=function(){var b=this.getSong();if(!b){return false}var c=[];for(var d in b.sources){c.push(d)}return c};this.getAudioDuration=function(){if(!this.sCurrentChannel){return false}return this.oAudio.duration};this.getAudioNetworkstate=function(){var b=this.oAudio?this.oAudio:document.getElementById("mcp"+this.getAudioChannels());return b?b.networkState:false};this.getAudioPosition=function(){if(!this.sCurrentChannel){return false}return this.oAudio.currentTime};this.getAudioReadystate=function(){var b=this.oAudio?this.oAudio:document.getElementById("mcp"+this.getAudioChannels());return b?b.readyState:false};this.getAudioSrc=function(){if(!this.sCurrentChannel){return false}return this.oAudio.currentSrc};this.getVolume=function(){if(this.oAudio){this.cfg.settings.volume=this.oAudio.volume;return this.cfg.settings.volume}return false};this.getPlaylist=function(){return(!this.aPL||!this.aPL.length)?false:this.aPL};this.getPlaylistCount=function(){return(this.aPL?this.aPL.length:false)};this.getPlayorder=function(){return this.aPlayorderList};this.getSong=function(){if(!this.aPL||!this.aPL.length){return false}return this.aPL[this.iCurrentSong]};this.getSongId=function(){return this.iCurrentSong};this._getSongItem=function(c){var b=this.getSong();return b?b[c]:false};this.getSongTitle=function(){return this._getSongItem("title")};this.getSongArtist=function(){return this._getSongItem("artist")};this.getSongAlbum=function(){return this._getSongItem("album")};this.getSongYear=function(){return this._getSongItem("year")};this.getSongImage=function(){return this._getSongItem("image")};this.getSongGenre=function(){return this._getSongItem("genre")};this.getSongBpm=function(){return this._getSongItem("bpm")};this.getSongUrl=function(){return this._getSongItem("url")};this.getPlaylistId=function(){return this.iPlaylistId};this.isMuted=function(){return(this.oAudio&&(this.oAudio.muted||!this.oAudio.volume))};this.isPaused=function(){return(this.oAudio&&this.oAudio.paused&&this.oAudio.currentTime!==0)};this.isPlaying=function(){return(this.oAudio&&!this.oAudio.paused)};this.isRepeatlist=function(){return(this.cfg.settings.repeatlist?!!this.cfg.settings.repeatlist:false)};this.isShuffled=function(){return(this.cfg.settings.shuffle?this.cfg.settings.shuffle:false)};this.isStopped=function(){return(!this.oAudio||this.oAudio.currentTime===0)};this.isStream=function(){return(this.oAudio&&this.oAudio.isStream)};this.updateOnResize=function(){var f=document.documentElement.clientWidth+" x "+document.documentElement.clientHeight;if(this.sScreensize&&f==this.sScreensize){return false}this.sScreensize=f;var d=["player","about","download","playlist"];for(var c=0;c<d.length;c++){var e=d[c];var b=this._togglehelperGetDiv(e);var h=b.style.top.replace("px","")/1;var g=b.style.left.replace("px","")/1;if(this.isVisibleBox(e)){if(h<0||h>(document.documentElement.clientHeight-50)){b.style.top=e==="player"?(document.documentElement.clientHeight-b.clientHeight-50)+"px":""}if(g>(document.documentElement.clientWidth-b.clientWidth)){b.style.left=(document.documentElement.clientWidth-b.clientWidth)+"px"}if(g<0){b.style.left="0px"}}else{if(h<(document.documentElement.clientHeight+this._iMinDelta)){this.toggleBoxAndButton(e,"minimize",true)}}}};this.updateStatus=function(){var b=this.getAudioNetworkstate();if(b){var c=this.getAudioReadystate();document.getElementById("mcpstatusnetwork").innerHTML='<span class="networkstate'+b+'" title="'+this.cfg.aPlayer.status.networkstate[b][1]+'">'+this.cfg.aPlayer.status.networkstate[b][0]+"</span>";document.getElementById("mcpstatusready").innerHTML='<span class="readystate'+c+'" title="'+this.cfg.aPlayer.status.readystate[c][1]+'">'+this.cfg.aPlayer.status.readystate[c][0]+"</span>"}else{document.getElementById("mcpstatusnetwork").innerHTML="-";document.getElementById("mcpstatusready").innerHTML="-"}this.updateOnResize();return true};this._getName=function(){for(var b in this.global){if(this.global[b]===this){return this._setName(b)}}};this._setName=function(b){this.name=b;return this.name};this.init=function(){this._getName();this._generatePlaylist();this._initHtml();if(typeof addi!=="undefined"){addi.init()}this.minimizeBox("about",true);this.minimizeBox("download",true);this.minimizeBox("playlist",true);window.setInterval(this.name+".updateStatus()",500);return true};if(arguments[0]){this.setConfig(arguments[0])}this.canPlaySurround();try{this.sCurrentChannel=localStorage.getItem("amcp.channels")?localStorage.getItem("amcp.channels"):false;this.cfg.settings.volume=localStorage.getItem("amcp.volume")?localStorage.getItem("amcp.volume"):1}catch(a){}return true};mcPlayer.prototype.global=this;var realMerge=function(c,b){for(var a in b){if(typeof c[a]!=="object"){c[a]=b[a]}else{if(typeof b[a]==="object"){c[a]=realMerge(c[a],b[a])}}}return c};