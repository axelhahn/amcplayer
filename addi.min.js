var addi={_saveData:[],_dragClass:"draggable",_dragOpacity:.8,_addi_zIndex:100,oFence:{bFullscreen:!0,top:0,left:0,width:window.innerWidth,height:window.innerHeight},_savstyles:{transition:"auto"},init:function(t){t&&(this._dragClass=t);var e=document.getElementsByClassName(this._dragClass);if(e&&e.length)for(var i=0;i<e.length;i++)this.initDiv(e[i],!1)},_fixVisiblePosition:function(t,e,i){this._updateFence(t.style.paddingLeft);var n=window.getComputedStyle(t),s=0+parseInt(n.borderLeftWidth)+parseInt(n.borderRightWidth)+parseInt(n.marginLeft)+parseInt(n.marginRight)+parseInt(n.paddingLeft)+parseInt(n.paddingRight),a=0+parseInt(n.borderTopWidth)+parseInt(n.borderBottomWidth)+parseInt(n.marginTop)+parseInt(n.marginBottom)+parseInt(n.paddingTop)+parseInt(n.paddingBottom);return e=Math.max(this.oFence.left,e),e=Math.min(this.oFence.left+this.oFence.width-t.clientWidth-s,e),i=Math.max(this.oFence.top,i),{xpos:e,ypos:i=Math.min(this.oFence.top+this.oFence.height-t.clientHeight-a,i)}},_getVarname:function(t){return"addi.saveddiv-"+t},_save:function(t){aData={left:t.style.left.replace("px",""),top:t.style.top.replace("px","")},localStorage.setItem(this._getVarname(t.id),JSON.stringify(aData))},_styleSave:function(t){var e=window.getComputedStyle(t);for(var i in void 0===this._saveData[t.id]&&(this._saveData[t.id]=new Object),this._savstyles)this._saveData[t.id][i]=e.getPropertyValue(i),t.style[i]=this._savstyles[i];return!0},_styleRestore:function(t){for(var e in this._savstyles)t.style[e]=this._saveData[t.id][e];return!0},_updateFence:function(){this.oFence.bFullscreen&&(this.oFence={bFullscreen:!0,top:0,left:0,width:window.innerWidth,height:window.innerHeight})},initDiv:function(t,e){var i=t.id;if(!i)return!1;o=e||t,o.onmousedown=function(t){addi._isDragging=!0,addi.startMoving(document.getElementById(i),t)},o.onmouseup=function(){addi._isDragging=!1,addi.stopMoving(document.getElementById(i))},!1!==t.className.indexOf("saveposition")&&this.load(t)},load:function(t){var e=this._getVarname(t.id),i=t.currentStyle||window.getComputedStyle(t);i.zIndex&&i.zIndex>0&&(this._addi_zIndex=Math.max(parseInt(i.zIndex),this._addi_zIndex)),t.style.zIndex=this._addi_zIndex++;var n=!!localStorage.getItem(e)&&JSON.parse(localStorage.getItem(e));return n&&n.left&&n.top&&this.move(t,n.left,n.top,!0),n},move:function(t,e,i,n){t.style.bottom="auto";var s=n?{xpos:e,ypos:i}:this._fixVisiblePosition(t,e,i);return t.style.left=s.xpos+"px",t.style.top=s.ypos+"px",this._save(t),!0},startMoving:function(t,e){if(!1===t.className.indexOf(this._dragClass))return!1;var i=(e=e||window.event).clientX,n=e.clientY;this._styleSave(t),document.body.style.userSelect="none",iDivWidth=parseInt(t.style.width),iDivHeight=parseInt(t.style.height),t.style.cursor="move",t.style.zIndex=this._addi_zIndex++,iDivLeft=t.style.left?t.style.left.replace("px",""):t.offsetLeft,iDivTop=t.style.top?t.style.top.replace("px",""):t.offsetTop;var s=i-iDivLeft,a=n-iDivTop;return document.onmousemove=function(e){var i=(e=e||window.event).clientX,n=e.clientY,o=i-s,d=n-a;t.style.opacity=addi._dragOpacity,addi.move(t,o,d)},!0},stopMoving:function(t){t.style.cursor="default",this._styleRestore(t),document.body.style.userSelect="auto",t.style.opacity=1,document.onmousemove=function(){}},XXreset:function(t,e){t||(t=this._dragClass);var i=document.getElementsByClassName(t);if(i&&i.length)for(var n=0;n<i.length;n++)this._resetDiv(i[n],e)},_resetDiv:function(t,e){t.onmousemove=null,t.onmouseup=null,t.onmousedown=null,e&&localStorage.delItem(this._getVarname(t.id))}};